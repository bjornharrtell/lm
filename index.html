<!DOCTYPE html>
<html>
  <head>
    <title>Mapbox Vector Tiles</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="http://openlayers.org/en/v3.15.1/css/ol.css" type="text/css">
    <script src="http://openlayers.org/en/v3.15.1/build/ol.js"></script>
    <style>
      .map {
        background: #f8f4f0;
      }
    </style>
  </head>
  <body>
    <div id="map" class="map"></div>
    <script>
      const origin = [218128, 6126002]
      const resolutions = [4096, 2048, 1024, 512, 256, 128, 64, 32, 16, 8, 4, 2, 1, 0.5]
      const source = new ol.source.VectorTile({
        attributions: '© Lantmäteriet',
        format: new ol.format.MVT(),
        tileGrid: new ol.tilegrid.TileGrid({origin, resolutions}),
        tilePixelRatio: 16,
        tileUrlFunction: c => `terrang/${c[0]}/${c[1]}/${c[2]}.pbf`
      })
      const style = function(f, res) {
        const kkod = f.get('kkod')
        
        if (kkod == 24 && res > 256) return []
        
        const widthMap = {
          21: 2,
          23: 1.5,
          24: 1
        }
        const dashMap = {
          21: [5, 5],
          23: [5, 5],
          24: [5, 5]
        }
        const colorMap = {
          21: '#000000',
          23: '#000000',
          24: '#888888'
        }
        return [
          new ol.style.Style({
            stroke: new ol.style.Stroke({
              color: colorMap[kkod],
              width: widthMap[kkod],
              lineDash: dashMap[kkod]
            })
          })
        ]
      }
      const layer = new ol.layer.VectorTile({ source, style })
      var map = new ol.Map({
        layers: [ layer ],
        target: 'map',
        view: new ol.View({
          center: [500000, 6700000],
          resolutions,
          zoom: 1
        })
      })
    </script>
  </body>
</html>
